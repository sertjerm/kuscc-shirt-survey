
// ===================================================================
// ‚ú® NEW: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏à‡∏≤‡∏Å API
// ===================================================================

let cachedSizes = null;

export const getShirtSizes = async () => {
  if (cachedSizes) {
    return cachedSizes;
  }

  try {
    console.log("üîç Fetching shirt sizes from API...");
    const res = await api.get("/GetShirtSizes");

    if (res.data?.responseCode !== 200) {
      throw new Error(res.data?.responseMessage || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡πÑ‡∏î‡πâ");
    }

    cachedSizes = res.data.data || [];
    cachedSizes.sort((a, b) => a.SORT_ORDER - b.SORT_ORDER);

    console.log("‚úÖ Loaded shirt sizes:", cachedSizes);
    return cachedSizes;
  } catch (error) {
    console.error("‚ùå Error fetching shirt sizes:", error);
    return getDefaultSizes();
  }
};

export const getSizeOrder = async () => {
  const sizes = await getShirtSizes();
  return sizes.map(s => s.SIZE_CODE);
};

export const getSizeOrderMap = async () => {
  const sizes = await getShirtSizes();
  return sizes.reduce((acc, size) => {
    acc[size.SIZE_CODE] = size.SORT_ORDER;
    return acc;
  }, {});
};

export const getSizeInfo = async (sizeCode) => {
  const sizes = await getShirtSizes();
  return sizes.find(s => s.SIZE_CODE === sizeCode) || null;
};

const getDefaultSizes = () => {
  return [
    { CHEST_INCH: 38, LENGTH_INCH: 23, REMARKS: "‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏Å", SIZE_CODE: "MINI", SIZE_NAME: "‡∏°‡∏¥‡∏ô‡∏¥‡πÑ‡∏ã‡∏™‡πå", SIZE_NAME_EN: "Mini Size", SORT_ORDER: 0 },
    { CHEST_INCH: 40, LENGTH_INCH: 24, REMARKS: null, SIZE_CODE: "XS", SIZE_NAME: "‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå‡∏ï‡∏£‡πâ‡∏≤ ‡∏™‡∏°‡∏≠‡∏•‡∏•‡πå", SIZE_NAME_EN: "Extra Small", SORT_ORDER: 1 },
    { CHEST_INCH: 42, LENGTH_INCH: 25, REMARKS: null, SIZE_CODE: "S", SIZE_NAME: "‡∏™‡∏°‡∏≠‡∏•‡∏•‡πå", SIZE_NAME_EN: "Small", SORT_ORDER: 2 },
    { CHEST_INCH: 44, LENGTH_INCH: 26, REMARKS: null, SIZE_CODE: "M", SIZE_NAME: "‡∏°‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏°", SIZE_NAME_EN: "Medium", SORT_ORDER: 3 },
    { CHEST_INCH: 46, LENGTH_INCH: 27, REMARKS: null, SIZE_CODE: "L", SIZE_NAME: "‡∏•‡∏≤‡∏£‡πå‡∏à", SIZE_NAME_EN: "Large", SORT_ORDER: 4 },
    { CHEST_INCH: 48, LENGTH_INCH: 28, REMARKS: null, SIZE_CODE: "XL", SIZE_NAME: "‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå‡∏ï‡∏£‡πâ‡∏≤ ‡∏•‡∏≤‡∏£‡πå‡∏à", SIZE_NAME_EN: "Extra Large", SORT_ORDER: 5 },
    { CHEST_INCH: 50, LENGTH_INCH: 29, REMARKS: null, SIZE_CODE: "2XL", SIZE_NAME: "‡∏ó‡∏π ‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå ‡∏•‡∏≤‡∏£‡πå‡∏à", SIZE_NAME_EN: "2X Large", SORT_ORDER: 6 },
    { CHEST_INCH: 52, LENGTH_INCH: 30, REMARKS: null, SIZE_CODE: "3XL", SIZE_NAME: "‡∏ó‡∏£‡∏µ ‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå ‡∏•‡∏≤‡∏£‡πå‡∏à", SIZE_NAME_EN: "3X Large", SORT_ORDER: 7 },
    { CHEST_INCH: 54, LENGTH_INCH: 31, REMARKS: null, SIZE_CODE: "4XL", SIZE_NAME: "‡πÇ‡∏ü‡∏£‡πå ‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå ‡∏•‡∏≤‡∏£‡πå‡∏à", SIZE_NAME_EN: "4X Large", SORT_ORDER: 8 },
    { CHEST_INCH: 56, LENGTH_INCH: 32, REMARKS: null, SIZE_CODE: "5XL", SIZE_NAME: "‡πÑ‡∏ü‡∏ß‡πå ‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå ‡∏•‡∏≤‡∏£‡πå‡∏à", SIZE_NAME_EN: "5X Large", SORT_ORDER: 9 },
    { CHEST_INCH: 58, LENGTH_INCH: 33, REMARKS: null, SIZE_CODE: "6XL", SIZE_NAME: "‡∏ã‡∏¥‡∏Å‡∏ã‡πå ‡πÄ‡∏≠‡πá‡∏Å‡∏ã‡πå ‡∏•‡∏≤‡∏£‡πå‡∏à", SIZE_NAME_EN: "6X Large", SORT_ORDER: 10 },
    { CHEST_INCH: 60, LENGTH_INCH: 34, REMARKS: "‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏û‡∏¥‡πÄ‡∏®‡∏© ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©", SIZE_CODE: "PLUS", SIZE_NAME: "‡∏û‡∏•‡∏±‡∏™‡πÑ‡∏ã‡∏™‡πå", SIZE_NAME_EN: "Plus Size", SORT_ORDER: 11 },
  ];
};

